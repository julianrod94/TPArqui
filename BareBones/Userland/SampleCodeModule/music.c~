#include "syscallwrappers.h"
#include "stdio.h"
#include "time.h"

static uint16_t getNote() {

	uint16_t note;
	read(STDIN, (uint64_t)&note, 1, 3, 0);
	return note; 
	
}


static void playNote(uint16_t note) {
	//if (note != 0)printf("%d", (int)note);
	write(SPK, (uint64_t)&note, 0, 0, 0);
}



void pianoPlay(void) {

	uint16_t note;
	uint8_t wasPlaying = 0;
	while(1) {

		note = getNote();

		if (note == 1) {
			break;
		}
		if (note != 0 && !wasPlaying) {
			playNote(note);
			wasPlaying = 1;
		} else if (note == 0) {
			wasPlaying = 0;
			playNote(note);
		}	
		sleep(56); /* minimum sleep time */
	}

}
